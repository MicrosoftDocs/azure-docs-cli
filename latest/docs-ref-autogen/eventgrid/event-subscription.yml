### YamlMime:AzureCLIGroup
uid: az_eventgrid_event-subscription
name: az eventgrid event-subscription
summary: Manage event subscriptions.
description: Manage event subscriptions for an Event Grid topic, domain, domain topic, Azure subscription, resource group or for any other Azure resource that supports event notifications.
directCommands:
- uid: az_eventgrid_event-subscription_create
  name: az eventgrid event-subscription create
  summary: Create a new event subscription.
  description: ''
  syntax: >-
    az eventgrid event-subscription create --name
                                           [--aad-tenant-id]
                                           [--advanced-filter]
                                           [--azure-active-directory-application-id-or-uri]
                                           [--deadletter-endpoint]
                                           [--deadletter-identity {systemassigned}]
                                           [--deadletter-identity-endpoint]
                                           [--delivery-attribute-mapping]
                                           [--delivery-identity {systemassigned}]
                                           [--delivery-identity-endpoint]
                                           [--delivery-identity-endpoint-type {azurefunction, eventhub, hybridconnection, servicebusqueue, servicebustopic, storagequeue, webhook}]
                                           [--enable-advanced-filtering-on-arrays {false, true}]
                                           [--endpoint]
                                           [--endpoint-type]
                                           [--event-delivery-schema {cloudeventschemav1_0, custominputschema, eventgridschema}]
                                           [--event-ttl]
                                           [--expiration-date]
                                           [--included-event-types]
                                           [--labels]
                                           [--max-delivery-attempts]
                                           [--max-events-per-batch]
                                           [--preferred-batch-size-in-kilobytes]
                                           [--qttl]
                                           [--source-resource-id]
                                           [--subject-begins-with]
                                           [--subject-case-sensitive {false, true}]
                                           [--subject-ends-with]
  examples:
  - summary: Create a new event subscription for an Event Grid topic, using default filters.
    syntax: >-
      az eventgrid event-subscription create --name es1 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/topics/topic1 \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code
  - summary: Create a new event subscription for an Azure subscription, using default filters.
    syntax: >-
      az eventgrid event-subscription create --name es2 \
          --source-resource-id /subscriptions/{SubID} \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code
  - summary: Create a new event subscription for a resource group, using default filters.
    syntax: >-
      az eventgrid event-subscription create --name es3 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG} \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code
  - summary: Create a new event subscription for a storage account, using default filters.
    syntax: >-
      az eventgrid event-subscription create --name es3 \
          --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/s1"  \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code
  - summary: Create a new event subscription for a storage account, using advanced filters.
    syntax: >-
      az eventgrid event-subscription create  --name es3 \
          --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/s1" \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code
          --advanced-filter data.blobType StringIn BlockBlob
          --advanced-filter data.url StringBeginsWith https://myaccount.blob.core.windows.net
  - summary: Create a new event subscription for an Azure subscription, with a filter specifying a subject prefix.
    syntax: >-
      az eventgrid event-subscription create --name es4 \
          --source-resource-id /subscriptions/{SubID} \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code \
          --subject-begins-with mysubject_prefix
  - summary: Create a new event subscription for a resource group, with a filter specifying a subject suffix.
    syntax: >-
      az eventgrid event-subscription create --name es5 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG} \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code \
          --subject-ends-with mysubject_suffix
  - summary: Create a new event subscription for an Azure subscription, using default filters, and an EventHub as a destination.
    syntax: >-
      az eventgrid event-subscription create --name es2 \
          --source-resource-id /subscriptions/{SubID} \
          --endpoint-type eventhub \
          --endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.EventHub/namespaces/n1/eventhubs/EH1
  - summary: Create a new event subscription for an Azure subscription, using default filters, and an Azure Storage queue as a destination.
    syntax: >-
      az eventgrid event-subscription create --name es2 \
          --source-resource-id /subscriptions/{SubID} \
          --endpoint-type storagequeue \
          --endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.Storage/storageAccounts/sa1/queueservices/default/queues/q1
  - summary: Create a new event subscription for an Azure subscription, using default filters, and an Azure ServiceBusQueue as a destination.
    syntax: >-
      az eventgrid event-subscription create --name es2 \
          --source-resource-id /subscriptions/{SubID} \
          --endpoint-type servicebusqueue \
          --endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.ServiceBus/namespaces/ns1/queues/queue1
  - summary: Create a new event subscription for an Event Grid domain, using default filters, and CloudEvent V 1.0 as the delivery schema.
    syntax: >-
      az eventgrid event-subscription create --name es2 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/domains/d1 \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code \
          --event-delivery-schema cloudeventschemav1_0
  - summary: Create a new event subscription for a storage account, with a deadletter destination and custom retry policy of maximum 10 delivery attempts and an Event TTL of 2 hours (whichever happens earlier).
    syntax: >-
      az eventgrid event-subscription create --name es2 \
          --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/s1" \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code \
          --deadletter-endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.Storage/storageAccounts/s2/blobServices/default/containers/blobcontainer1 \
          --max-delivery-attempts 10 --event-ttl 120
  - summary: Create a new event subscription for a domain topic.
    syntax: >-
      az eventgrid event-subscription create --name es2 \
          --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/domains/domain1/topics/t1" \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code
  - summary: Create a new event subscription (for a storage account) with an expiration date.
    syntax: >-
      az eventgrid event-subscription create --name es2 \
          --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/sa1" \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code
          --expiration-date "2018-10-31"
  - summary: Create a new event subscription for an Event Grid topic, using Azure Active Directory enabled Webhook as a destination .
    syntax: >-
      az eventgrid event-subscription create --name es1 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/topics/topic1 \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code
          --azure-active-directory-tenant-id azureactivedirectorytenantid
          --azure-active-directory-application-id-or-uri azureactivedirectoryapplicationidoruri
  - summary: Create a new event subscription for an Event Grid topic, using Azure Function as destination.
    syntax: >-
      az eventgrid event-subscription create --name es1 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/topics/topic1 \
          --endpoint /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Web/sites/{functionappname}/functions/{functionname} --endpoint-type azurefunction
  - summary: Create a new event subscription for an Event Grid topic, using Eventhub with systemassigned MSI identity as destination and with deadletter with MSI identity
    syntax: >-
      az eventgrid event-subscription create --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/topics/topic1 \
          --delivery-identity-endpoint-type eventhub --delivery-identity systemassigned --delivery-identity-endpoint /subscriptions/{SubId2|}/resourceGroups/{RG2}/providers/Microsoft.eventhub/namespaces/{EventHubNamespace}/eventhubs/{EventhubName} \
          --deadletter-identity-endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.Storage/storageAccounts/s2/blobServices/default/containers/blobcontainer1 --deadletter-identity systemassigned -n {EventSubscriptionName}
  - summary: Create a new event subscription for an Event Grid topic using Storage Queue as destination with message ttl at 5 mins
    syntax: >-
      az eventgrid event-subscription create -n es1 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/topics/topic1
          --endpoint-type storagequeue \
          --endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.Storage/storageAccounts/sa1/queueservices/default/queues/q1 \
          --storage-queue-msg-ttl 300
  - summary: Create a new event subscription for an Event Grid topic using StorageQueue with systemassigned MSI identity as destination
    syntax: >-
      az eventgrid event-subscription create -n {EventSubscriptionName} --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/topics/topic1 \
          --delivery-identity-endpoint-type StorageQueue --delivery-identity systemassigned --delivery-identity-endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.Storage/storageAccounts/sa1/queueservices/default/queues/q1 \
          --storage-queue-msg-ttl 300
  - summary: Create a new event subscription for an Event Grid topic with advanced filtering enabled on arrays
    syntax: >-
      az eventgrid event-subscription create -n es1 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/topics/topic1
          --endpoint-type storagequeue \
          --endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.Storage/storageAccounts/sa1/queueservices/default/queues/q1 \
          --enable-advanced-filtering-on-arrays true
  requiredParameters:
  - isRequired: true
    name: --name -n
    summary: Name of the event subscription.
    description: ''
  optionalParameters:
  - name: --aad-tenant-id --azure-active-directory-tenant-id
    summary: The Azure Active Directory Tenant Id to get the access token that will be included as the bearer token in delivery requests. Applicable only for webhook as a destination.
    description: ''
  - name: --advanced-filter
    summary: An advanced filter enables filtering of events based on a specific event property.
    description: >-
      Usage:                     --advanced-filter KEY[.INNERKEY] FILTEROPERATOR VALUE [VALUE ...]

      StringIn:                  --advanced-filter data.Color StringIn Blue Red Orange Yellow

      StringNotIn:               --advanced-filter data.Color StringNotIn Blue Red Orange Yellow

      StringContains:            --advanced-filter subject StringContains Blue Red

      StringNotContains:         --advanced-filter subject StringNotContains Blue Red

      StringBeginsWith:          --advanced-filter subject StringBeginsWith Blue Red

      StringNotBeginsWith:       --advanced-filter subject StringNotBeginsWith Blue Red

      StringEndsWith:            --advanced-filter subject StringEndsWith img png jpg

      StringNotEndsWith:         --advanced-filter subject StringNotEndsWith img png jpg

      NumberIn:                  --advanced-filter data.property1 NumberIn 5 10 20

      NumberInRange              --advanced-filter data.property1 NumberInRange 5,10 20,30 40,50

      NumberNotIn:               --advanced-filter data.property2 NumberNotIn 100 200 300

      NumberNotInRange:          --advanced-filter data.property2 NumberNotInRange 100,110 200,210 300,310

      NumberLessThan:            --advanced-filter data.property3 NumberLessThan 100

      NumberLessThanOrEquals:    --advanced-filter data.property2 NumberLessThanOrEquals 100

      NumberGreaterThan:         --advanced-filter data.property3 NumberGreaterThan 100

      NumberGreaterThanOrEquals: --advanced-filter data.property2 NumberGreaterThanOrEquals 100

      BoolEquals:                --advanced-filter data.property3 BoolEquals true

      IsNullOrUndefined:         --advanced-filter data.property3 IsNullOrUndefined

      IsNotNull:                 --advanced-filter data.property3 IsNotNull

      Multiple advanced filters can be specified by using more than one `--advanced-filter` argument.
  - name: --azure-active-directory-application-id-or-uri
    summary: The Azure Active Directory Application Id or Uri to get the access token that will be included as the bearer token in delivery requests. Applicable only for webhook as a destination.
    description: ''
  - name: --deadletter-endpoint
    summary: The Azure resource ID of an Azure Storage blob container destination where EventGrid should deadletter undeliverable events for this event subscription.
    description: 'Example: --deadletter-endpoint /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.Storage/storageAccounts/sa1/blobServices/default/containers/containerName.'
  - name: --deadletter-identity
    parameterValueGroup: "systemassigned"
    summary: The identity type of the deadletter destination resource.
    description: ''
  - name: --deadletter-identity-endpoint
    summary: The Azure resource ID of an Azure Storage blob container destination with identity where EventGrid should deadletter undeliverable events for this event subscription.
    description: ''
  - name: --delivery-attribute-mapping
    summary: Add delivery attribute mapping to send additional information via HTTP headers when delivering events. This attribute is valid for all destination types except StorageQueue. Multiple attributes can be specified by using more than one `--delivery-attribute-mapping` argument.
    description: >-
      Usage:                        --delivery-attribute-mapping attribute-name attribute-type attribute-value [attribute-is-secret]

      Static Attribute Mapping:     --delivery-attribute-mapping somename static somevalue

      Static Attribute Mapping:     --delivery-attribute-mapping somename static somevalue false

      Static Attribute Mapping:     --delivery-attribute-mapping somename static somevalue true

      Dynamic Attribute Mapping:    --delivery-attribute-mapping somename dynamic somevalue

      Both Static and Dynamic:      --delivery-attribute-mapping somename dynamic somevalue --delivery-attribute-mapping somename2 static somevalue.
  - name: --delivery-identity
    parameterValueGroup: "systemassigned"
    summary: The identity type of the delivery destination resource (e.g., storage queue, or eventhub).
    description: ''
  - name: --delivery-identity-endpoint
    summary: Endpoint with identity where EventGrid should deliver events matching this event subscription. For webhook endpoint type, this should be the corresponding webhook URL. For other endpoint types, this should be the Azure resource identifier of the endpoint.
    description: ''
  - name: --delivery-identity-endpoint-type
    parameterValueGroup: "azurefunction, eventhub, hybridconnection, servicebusqueue, servicebustopic, storagequeue, webhook"
    summary: The type of the destination endpoint with resource identity.
    description: ''
  - name: --enable-advanced-filtering-on-arrays --enable-af-arr
    parameterValueGroup: "false, true"
    summary: Allows advanced filters to be evaluated against an array of values instead of expecting a singular value.
    description: ''
  - name: --endpoint
    summary: Endpoint where EventGrid should deliver events matching this event subscription. For webhook endpoint type, this should be the corresponding webhook URL. For other endpoint types, this should be the Azure resource identifier of the endpoint. It is expected that the destination endpoint to be already created and available for use before executing any Event Grid command.
    description: ''
  - name: --endpoint-type
    defaultValue: "webhook"
    summary: The type of the destination endpoint.
    description: ''
  - name: --event-delivery-schema
    parameterValueGroup: "cloudeventschemav1_0, custominputschema, eventgridschema"
    summary: The schema in which events should be delivered for this event subscription. By default, events will be delivered in the same schema in which they are published (based on the corresponding topic's input schema).
    description: ''
  - name: --event-ttl
    defaultValue: "1440"
    summary: Event time to live (in minutes). Must be a number between 1 and 1440.
    description: ''
  - name: --expiration-date
    summary: Date or datetime (in UTC, e.g. '2018-11-30T11:59:59+00:00' or '2018-11-30') after which the event subscription would expire. By default, there is no expiration for the event subscription.
    description: ''
  - name: --included-event-types
    summary: A space-separated list of event types (e.g., Microsoft.Storage.BlobCreated and Microsoft.Storage.BlobDeleted). In order to subscribe to all default event types, do not specify any value for this argument. For event grid topics, event types are customer defined. For Azure events, e.g., Storage Accounts, IoT Hub, etc., you can query their event types using this CLI command 'az eventgrid topic-type list-event-types'.
    description: ''
  - name: --labels
    summary: A space-separated list of labels to associate with this event subscription.
    description: ''
  - name: --max-delivery-attempts
    defaultValue: "30"
    summary: Maximum number of delivery attempts. Must be a number between 1 and 30.
    description: ''
  - name: --max-events-per-batch
    summary: Maximum number of events in a batch. Must be a number between 1 and 5000.
    description: ''
  - name: --preferred-batch-size-in-kilobytes
    summary: Preferred batch size in kilobytes. Must be a number between 1 and 1024.
    description: ''
  - name: --qttl --storage-queue-msg-ttl
    summary: Storage queue message time to live in seconds.
    description: ''
  - name: --source-resource-id
    summary: Fully qualified identifier of the Azure resource to which the event subscription needs to be created.
    description: >-
      Usage:                      --source-resource-id Azure-Resource-ID

      For Azure subscription:     --source-resource-id /subscriptions/{SubID}

      For resource group:         --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1

      For EventGrid topic:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/topics/t1

      For storage account:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.Storage/storageaccounts/sa1

      For EventGrid domain:       --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1

      For EventGrid domain topic: --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1/topics/t1.
  - name: --subject-begins-with
    summary: An optional string to filter events for an event subscription based on a prefix. Wildcard characters are not supported.
    description: ''
  - name: --subject-case-sensitive
    defaultValue: "False"
    parameterValueGroup: "false, true"
    summary: Specify to indicate whether the subject fields should be compared in a case sensitive manner. True if flag present.
    description: ''
  - name: --subject-ends-with
    summary: An optional string to filter events for an event subscription based on a suffix. Wildcard characters are not supported.
    description: ''
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/eventgrid/_help.py
- uid: az_eventgrid_event-subscription_delete
  name: az eventgrid event-subscription delete
  summary: Delete an event subscription.
  description: ''
  syntax: >-
    az eventgrid event-subscription delete --name
                                           [--source-resource-id]
  examples:
  - summary: Delete an event subscription for an Event Grid topic.
    syntax: >-
      az eventgrid event-subscription delete --name es1 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/topics/topic1
  - summary: Delete an event subscription for an Event Grid domain topic.
    syntax: >-
      az eventgrid event-subscription delete --name es1 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/domains/domain1/topics/topic1
  - summary: Delete an event subscription for an Event Grid domain.
    syntax: >-
      az eventgrid event-subscription delete --name es1 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/domains/domain1
  - summary: Delete an event subscription for an Azure subscription.
    syntax: >-
      az eventgrid event-subscription delete --name es2 \
          --source-resource-id /subscriptions/{SubID}
  - summary: Delete an event subscription for a resource group.
    syntax: >-
      az eventgrid event-subscription delete --name es3 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}
  - summary: Delete an event subscription for a storage account.
    syntax: >-
      az eventgrid event-subscription delete --name es3 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/microsoft.storage/storageaccounts/kalsegblob
  requiredParameters:
  - isRequired: true
    name: --name -n
    summary: Name of the event subscription.
    description: ''
  optionalParameters:
  - name: --source-resource-id
    summary: Fully qualified identifier of the Azure resource whose event subscription needs to be deleted.
    description: >-
      Usage:                      --source-resource-id Azure-Resource-ID

      For Azure subscription:     --source-resource-id /subscriptions/{SubID}

      For resource group:         --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1

      For EventGrid topic:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/topics/t1

      For storage account:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.Storage/storageaccounts/sa1

      For EventGrid domain:       --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1

      For EventGrid domain topic: --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1/topics/t1.
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/eventgrid/_help.py
- uid: az_eventgrid_event-subscription_list
  name: az eventgrid event-subscription list
  summary: List event subscriptions.
  description: >-
    Event Grid supports both regional and global event subscriptions: Event subscriptions on regional resources (such as Storage accounts or Event Grid topics) are regional, while event subscriptions on global resources (such as an Azure subscription or resource group) are global.

    Hence, you can list event subscriptions in a few different ways:

    1. To list by the resource ID of the resource whose event subscriptions you want to list, specify the --source-resource-id parameter. No other parameters must be specified.

    2. To list by a topic-type (e.g. storage accounts), specify the --topic-type parameter along with --location (e.g. "westus2") parameter. For global topic types (e.g. "Microsoft.Resources.Subscriptions"), specify the location value as "global".

    3. To list all event subscriptions in a region (across all topic types), specify only the --location parameter.

    4. For both #2 and #3 above, to filter only by a resource group, you can additionally specify the --resource-group parameter.
  syntax: >-
    az eventgrid event-subscription list [--location]
                                         [--odata-query]
                                         [--resource-group]
                                         [--source-resource-id]
                                         [--topic-type-name]
  examples:
  - summary: List all event subscriptions created for an Event Grid topic.
    syntax: az eventgrid event-subscription list --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/topics/topic1
  - summary: List all event subscriptions created for a storage account.
    syntax: az eventgrid event-subscription list --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/kalsegblob
  - summary: List all event subscriptions created for an Azure subscription.
    syntax: az eventgrid event-subscription list --source-resource-id /subscriptions/{SubID}
  - summary: List all event subscriptions created for a resource group.
    syntax: az eventgrid event-subscription list --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}
  - summary: List all event subscriptions for an Event Grid domain.
    syntax: az eventgrid event-subscription list --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/domains/d1
  - summary: List all event subscriptions for an Event Grid domain topic.
    syntax: az eventgrid event-subscription list --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/domains/d1/topics/topic1
  - summary: List all Storage event subscriptions (under the currently selected Azure subscription) in westus2.
    syntax: az eventgrid event-subscription list --topic-type Microsoft.Storage.StorageAccounts --location westus2
  - summary: List all Storage event subscriptions (under the given resource group) in westus2.
    syntax: az eventgrid event-subscription list --topic-type Microsoft.Storage.StorageAccounts --location westus2 --resource-group {RG}
  - summary: List all regional or global event subscriptions (under the currently selected Azure subscription).
    syntax: >-
      az eventgrid event-subscription list --location westus2

      az eventgrid event-subscription list --location global
  - summary: List all regional or global event subscriptions under a specified resource group.
    syntax: >-
      az eventgrid event-subscription list --location westus2 --resource-group {RG}

      az eventgrid event-subscription list --location global --resource-group {RG}
  - summary: List all event subscriptions for an Event Grid domain whose name contains the pattern "XYZ"
    syntax: az eventgrid event-subscription list --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/domains/d1 --odata-query "Contains(name, 'XYZ')"
  - summary: List all event subscriptions for an Event Grid domain except the event subscription with name "name1"
    syntax: az eventgrid event-subscription list --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/domains/d1 --odata-query "NOT (name eq 'name1')"
  optionalParameters:
  - name: --location -l
    summary: 'Location. Values from: `az account list-locations`. You can configure the default location using `az configure --defaults location=<location>`.'
    description: ''
  - name: --odata-query
    summary: 'The OData query used for filtering the list results. Filtering is currently allowed on the Name property only. The supported operations include: CONTAINS, eq (for equal), ne (for not equal), AND, OR and NOT.'
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --source-resource-id
    summary: Fully qualified identifier of the Azure resource whose event subscription needs to be listed.
    description: >-
      Usage:                      --source-resource-id Azure-Resource-ID

      For Azure subscription:     --source-resource-id /subscriptions/{SubID}

      For resource group:         --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1

      For EventGrid topic:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/topics/t1

      For storage account:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.Storage/storageaccounts/sa1

      For EventGrid domain:       --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1

      For EventGrid domain topic: --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1/topics/t1.
  - name: --topic-type-name
    summary: Name of the topic-type whose event subscriptions need to be listed. When this is specified, you must also specify --location.
    description: >-
      Example 1: List all Storage event subscriptions in WestUS2
          --resource-group TestRG --topic-type-name Microsoft.Storage.StorageAccounts --location westus2
      Example 2: List all event subscriptions on Azure subscriptions
          --topic-type-name Microsoft.Resources.Subscriptions --location global.
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/eventgrid/_help.py
- uid: az_eventgrid_event-subscription_show
  name: az eventgrid event-subscription show
  summary: Get the details of an event subscription.
  description: ''
  syntax: >-
    az eventgrid event-subscription show --name
                                         [--include-attrib-secret {false, true}]
                                         [--include-full-endpoint-url {false, true}]
                                         [--source-resource-id]
  examples:
  - summary: Show the details of an event subscription for an Event Grid topic.
    syntax: >-
      az eventgrid event-subscription show --name es1 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/topics/topic1
  - summary: Show the details of an event subscription for an Azure subscription.
    syntax: >-
      az eventgrid event-subscription show --name es2 \
          --source-resource-id /subscriptions/{SubID}
  - summary: Show the details of an event subscription for a resource group.
    syntax: >-
      az eventgrid event-subscription show --name es3 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1
  - summary: Show the details of an event subscription for a storage account.
    syntax: >-
      az eventgrid event-subscription show --name es3 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/microsoft.storage/storageaccounts/kalsegblob
  - summary: Show the details of an event subscription for a resource group including any static delivery attribute secrets.
    syntax: >-
      az eventgrid event-subscription show --name es3 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1 \
          --include-static-delivery-attribute-secret
  requiredParameters:
  - isRequired: true
    name: --name -n
    summary: Name of the event subscription.
    description: ''
  optionalParameters:
  - name: --include-attrib-secret --include-static-delivery-attribute-secret
    defaultValue: "False"
    parameterValueGroup: "false, true"
    summary: Indicate whether any static delivery attribute secrets should be returned. True if flag present.
    description: ''
  - name: --include-full-endpoint-url
    defaultValue: "False"
    parameterValueGroup: "false, true"
    summary: Specify to indicate whether the full endpoint URL should be returned. True if flag present.
    description: ''
  - name: --source-resource-id
    summary: Fully qualified identifier of the Azure resource whose event subscription needs to be shown.
    description: >-
      Usage:                      --source-resource-id Azure-Resource-ID

      For Azure subscription:     --source-resource-id /subscriptions/{SubID}

      For resource group:         --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1

      For EventGrid topic:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/topics/t1

      For storage account:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.Storage/storageaccounts/sa1

      For EventGrid domain:       --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1

      For EventGrid domain topic: --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1/topics/t1.
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/eventgrid/_help.py
- uid: az_eventgrid_event-subscription_update
  name: az eventgrid event-subscription update
  summary: Update an event subscription.
  description: ''
  syntax: >-
    az eventgrid event-subscription update --name
                                           [--add]
                                           [--advanced-filter]
                                           [--deadletter-endpoint]
                                           [--deadletter-identity {systemassigned}]
                                           [--deadletter-identity-endpoint]
                                           [--delivery-attribute-mapping]
                                           [--delivery-identity {systemassigned}]
                                           [--delivery-identity-endpoint]
                                           [--delivery-identity-endpoint-type {azurefunction, eventhub, hybridconnection, servicebusqueue, servicebustopic, storagequeue, webhook}]
                                           [--enable-advanced-filtering-on-arrays {false, true}]
                                           [--endpoint]
                                           [--endpoint-type]
                                           [--force-string]
                                           [--included-event-types]
                                           [--labels]
                                           [--qttl]
                                           [--remove]
                                           [--set]
                                           [--source-resource-id]
                                           [--subject-begins-with]
                                           [--subject-ends-with]
  examples:
  - summary: Update an event subscription for an Event Grid topic to specify a new endpoint.
    syntax: >-
      az eventgrid event-subscription update --name es1 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/topics/topic1 \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code
  - summary: Update an event subscription for an Azure subscription to specify a new subject-ends-with filter.
    syntax: >-
      az eventgrid event-subscription update --name es2 \
          --source-resource-id /subscriptions/{SubID} \
          --subject-ends-with .jpg
  - summary: Update an event subscription for a resource group to specify a new endpoint and a new subject-ends-with filter.
    syntax: >-
      az eventgrid event-subscription update --name es3 \
          --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG} \
          --subject-ends-with .png \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code
  - summary: Update an event subscription for a storage account to specify a new list of included event types.
    syntax: >-
      az eventgrid event-subscription update --name es3 \
          --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/microsoft.storage/storageaccounts/kalsegblob" \
          --included-event-types Microsoft.Storage.BlobCreated Microsoft.Storage.BlobDeleted
  - summary: Update an event subscription for a storage account, to include a deadletter destination.
    syntax: >-
      az eventgrid event-subscription update --name es2 \
          --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/kalsegblob" \
          --deadletter-endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.Storage/storageAccounts/sa1/blobServices/default/containers/blobcontainer1
  - summary: Update an event subscription for a storage account, using advanced filters.
    syntax: >-
      az eventgrid event-subscription update --name es3 \
          --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/s1" \
          --endpoint https://contoso.azurewebsites.net/api/f1?code=code
          --advanced-filter data.blobType StringIn BlockBlob
          --advanced-filter data.url StringBeginsWith https://myaccount.blob.core.windows.net
  - summary: Update an event subscription for a storage account to include message ttl set to 5 mins.
    syntax: >-
      az eventgrid event-subscription update --name es2 \
          --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/kalsegblob" \
          --storage-queue-msg-ttl 300
  - summary: Update an event subscription with advanced filtering enabled on arrays
    syntax: >-
      az eventgrid event-subscription update --name es2 \
          --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/kalsegblob" \
          --enable-advanced-filtering-on-arrays true
  requiredParameters:
  - isRequired: true
    name: --name -n
    summary: Name of the event subscription.
    description: ''
  optionalParameters:
  - name: --add
    defaultValue: "[]"
    summary: 'Add an object to a list of objects by specifying a path and key value pairs.  Example: --add property.listProperty <key=value, string or JSON string>.'
    description: ''
  - name: --advanced-filter
    summary: An advanced filter enables filtering of events based on a specific event property.
    description: >-
      Usage:                     --advanced-filter KEY[.INNERKEY] FILTEROPERATOR VALUE [VALUE ...]

      StringIn:                  --advanced-filter data.Color StringIn Blue Red Orange Yellow

      StringNotIn:               --advanced-filter data.Color StringNotIn Blue Red Orange Yellow

      StringContains:            --advanced-filter subject StringContains Blue Red

      StringNotContains:         --advanced-filter subject StringNotContains Blue Red

      StringBeginsWith:          --advanced-filter subject StringBeginsWith Blue Red

      StringNotBeginsWith:       --advanced-filter subject StringNotBeginsWith Blue Red

      StringEndsWith:            --advanced-filter subject StringEndsWith img png jpg

      StringNotEndsWith:         --advanced-filter subject StringNotEndsWith img png jpg

      NumberIn:                  --advanced-filter data.property1 NumberIn 5 10 20

      NumberInRange              --advanced-filter data.property1 NumberInRange 5,10 20,30 40,50

      NumberNotIn:               --advanced-filter data.property2 NumberNotIn 100 200 300

      NumberNotInRange:          --advanced-filter data.property2 NumberNotInRange 100,110 200,210 300,310

      NumberLessThan:            --advanced-filter data.property3 NumberLessThan 100

      NumberLessThanOrEquals:    --advanced-filter data.property2 NumberLessThanOrEquals 100

      NumberGreaterThan:         --advanced-filter data.property3 NumberGreaterThan 100

      NumberGreaterThanOrEquals: --advanced-filter data.property2 NumberGreaterThanOrEquals 100

      BoolEquals:                --advanced-filter data.property3 BoolEquals true

      IsNullOrUndefined:         --advanced-filter data.property3 IsNullOrUndefined

      IsNotNull:                 --advanced-filter data.property3 IsNotNull

      Multiple advanced filters can be specified by using more than one `--advanced-filter` argument.
  - name: --deadletter-endpoint
    summary: The Azure resource ID of an Azure Storage blob container destination where EventGrid should deadletter undeliverable events for this event subscription.
    description: ''
  - name: --deadletter-identity
    parameterValueGroup: "systemassigned"
    summary: The identity type of the deadletter destination resource.
    description: ''
  - name: --deadletter-identity-endpoint
    summary: The Azure resource ID of an Azure Storage blob container destination with identity where EventGrid should deadletter undeliverable events for this event subscription.
    description: ''
  - name: --delivery-attribute-mapping
    summary: Add delivery attribute mapping to send additional information via HTTP headers when delivering events. This attribute is valid for all destination types except StorageQueue. Multiple attributes can be specified by using more than one `--delivery-attribute-mapping` argument.
    description: >-
      Usage:                        --delivery-attribute-mapping attribute-name attribute-type attribute-value [attribute-is-secret]

      Static Attribute Mapping:     --delivery-attribute-mapping somename static somevalue

      Static Attribute Mapping:     --delivery-attribute-mapping somename static somevalue false

      Static Attribute Mapping:     --delivery-attribute-mapping somename static somevalue true

      Dynamic Attribute Mapping:    --delivery-attribute-mapping somename dynamic somevalue

      Both Static and Dynamic:      --delivery-attribute-mapping somename dynamic somevalue --delivery-attribute-mapping somename2 static somevalue.
  - name: --delivery-identity
    parameterValueGroup: "systemassigned"
    summary: The identity type of the delivery destination resource (e.g., storage queue, or eventhub).
    description: ''
  - name: --delivery-identity-endpoint
    summary: Endpoint with identity where EventGrid should deliver events matching this event subscription. For webhook endpoint type, this should be the corresponding webhook URL. For other endpoint types, this should be the Azure resource identifier of the endpoint.
    description: ''
  - name: --delivery-identity-endpoint-type
    parameterValueGroup: "azurefunction, eventhub, hybridconnection, servicebusqueue, servicebustopic, storagequeue, webhook"
    summary: The type of the destination endpoint with resource identity.
    description: ''
  - name: --enable-advanced-filtering-on-arrays --enable-af-arr
    parameterValueGroup: "false, true"
    summary: Allows advanced filters to be evaluated against an array of values instead of expecting a singular value.
    description: ''
  - name: --endpoint
    summary: Endpoint where EventGrid should deliver events matching this event subscription. For webhook endpoint type, this should be the corresponding webhook URL. For other endpoint types, this should be the Azure resource identifier of the endpoint. It is expected that the destination endpoint to be already created and available for use before executing any Event Grid command.
    description: ''
  - name: --endpoint-type
    defaultValue: "webhook"
    summary: The type of the destination endpoint.
    description: ''
  - name: --force-string
    defaultValue: "False"
    summary: When using 'set' or 'add', preserve string literals instead of attempting to convert to JSON.
    description: ''
  - name: --included-event-types
    summary: A space-separated list of event types (e.g., Microsoft.Storage.BlobCreated and Microsoft.Storage.BlobDeleted). In order to subscribe to all default event types, do not specify any value for this argument. For event grid topics, event types are customer defined. For Azure events, e.g., Storage Accounts, IoT Hub, etc., you can query their event types using this CLI command 'az eventgrid topic-type list-event-types'.
    description: ''
  - name: --labels
    summary: A space-separated list of labels to associate with this event subscription.
    description: ''
  - name: --qttl --storage-queue-msg-ttl
    summary: Storage queue message time to live in seconds.
    description: ''
  - name: --remove
    defaultValue: "[]"
    summary: 'Remove a property or an element from a list.  Example: --remove property.list <indexToRemove> OR --remove propertyToRemove.'
    description: ''
  - name: --set
    defaultValue: "[]"
    summary: 'Update an object by specifying a property path and value to set.  Example: --set property1.property2=<value>.'
    description: ''
  - name: --source-resource-id
    summary: Fully qualified identifier of the Azure resource whose event subscription needs to be updated.
    description: >-
      Usage:                      --source-resource-id Azure-Resource-ID

      For Azure subscription:     --source-resource-id /subscriptions/{SubID}

      For resource group:         --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1

      For EventGrid topic:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/topics/t1

      For storage account:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.Storage/storageaccounts/sa1

      For EventGrid domain:       --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1

      For EventGrid domain topic: --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1/topics/t1.
  - name: --subject-begins-with
    summary: An optional string to filter events for an event subscription based on a prefix. Wildcard characters are not supported.
    description: ''
  - name: --subject-ends-with
    summary: An optional string to filter events for an event subscription based on a suffix. Wildcard characters are not supported.
    description: ''
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/eventgrid/_help.py
commands:
- az_eventgrid_event-subscription_create
- az_eventgrid_event-subscription_delete
- az_eventgrid_event-subscription_list
- az_eventgrid_event-subscription_show
- az_eventgrid_event-subscription_update
globalParameters:
- name: --debug
  summary: Increase logging verbosity to show all debug logs.
- name: --help -h
  summary: Show this help message and exit.
- name: --only-show-errors
  summary: Only show errors, suppressing warnings.
- name: --output -o
  defaultValue: "json"
  parameterValueGroup: "json, jsonc, table, tsv"
  summary: Output format.
- name: --query
  summary: JMESPath query string. See <a href="http://jmespath.org/">http://jmespath.org/</a> for more information and examples.
- name: --subscription
  summary: Name or ID of subscription. You can configure the default subscription using `az account set -s NAME_OR_ID`.
- name: --verbose
  summary: Increase logging verbosity. Use --debug for full debug logs.
metadata:
  doc_source_url_repo: https://github.com/Azure/azure-cli/blob/dev/
  ms.date: 10/08/2022
  description: Manage event subscriptions for an Event Grid topic, domain, domain topic, Azure subscription, resource group or for any other Azure resource that supports event notifications.
