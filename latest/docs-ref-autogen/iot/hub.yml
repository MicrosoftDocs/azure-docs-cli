### YamlMime:AzureCLIGroup
uid: az_iot_hub
name: az iot hub
summary: Manage Azure IoT hubs.
description: ''
directCommands:
- uid: az_iot_hub_create
  name: az iot hub create
  summary: Create an Azure IoT hub.
  description: For an introduction to Azure IoT Hub, see https://docs.microsoft.com/azure/iot-hub/.
  syntax: >-
    az iot hub create --name
                      --resource-group
                      [--c2d-max-delivery-count]
                      [--c2d-ttl]
                      [--dds {false, true}]
                      [--disable-local-auth {false, true}]
                      [--disable-module-sas {false, true}]
                      [--edr {false, true}]
                      [--fc]
                      [--fcs]
                      [--fd]
                      [--feedback-lock-duration]
                      [--feedback-ttl]
                      [--fileupload-notification-lock-duration]
                      [--fileupload-notification-max-delivery-count]
                      [--fileupload-notification-ttl]
                      [--fileupload-notifications {false, true}]
                      [--fileupload-sas-ttl]
                      [--fileupload-storage-auth-type {identityBased, keyBased}]
                      [--fileupload-storage-identity]
                      [--location]
                      [--mi-system-assigned {false, true}]
                      [--mi-user-assigned]
                      [--min-tls-version]
                      [--no-wait]
                      [--partition-count]
                      [--rd]
                      [--role]
                      [--scopes]
                      [--sku {B1, B2, B3, F1, S1, S2, S3}]
                      [--tags]
                      [--unit]
  examples:
  - summary: Create an IoT Hub with the free pricing tier F1, in the region of the resource group.
    syntax: az iot hub create --resource-group MyResourceGroup --name MyIotHub --sku F1 --partition-count 2
  - summary: Create an IoT Hub with the standard pricing tier S1 and 4 partitions, in the 'westus' region, with tags.
    syntax: az iot hub create --resource-group MyResourceGroup --name MyIotHub --location westus --tags a=b c=d
  - summary: Create an IoT Hub with a system-assigned managed identity, and assign a role and scope to a storage account for the created identity.
    syntax: az iot hub create --resource-group MyResourceGroup --name MyIotHub --location westus --mi-system-assigned --role "Storage Blob Data Contributor" --scopes {resourceId}
  - summary: Create an IoT Hub with local authentication, device SAS keys, and module SAS keys all disabled
    syntax: az iot hub create --resource-group MyResourceGroup --name MyIotHub --location westus --disable-local-auth --disable-device-sas --disable-module-sas
  - summary: Create an IoT Hub with data residency enforced. This will disable cross-region disaster recovery.
    syntax: az iot hub create --resource-group MyResourceGroup --name MyIoTHub --edr
  requiredParameters:
  - isRequired: true
    name: --name -n
    summary: IoT Hub name.
    description: ''
  - isRequired: true
    name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  optionalParameters:
  - name: --c2d-max-delivery-count --cdd
    defaultValue: "10"
    summary: The number of times the IoT hub will attempt to deliver a cloud-to-device message to a device, between 1 and 100.
    description: ''
  - name: --c2d-ttl --ct
    defaultValue: "1"
    summary: The amount of time a message is available for the device to consume before it is expired by IoT Hub, between 1 and 48 hours.
    description: ''
  - name: --dds --disable-device-sas
    parameterValueGroup: "false, true"
    summary: A boolean indicating whether or not to disable all device (including Edge devices but excluding modules) scoped SAS keys for authentication.
    description: ''
  - name: --disable-local-auth --dla
    parameterValueGroup: "false, true"
    summary: A boolean indicating whether or not to disable IoT hub scoped SAS keys for authentication.
    description: ''
  - name: --disable-module-sas --dms
    parameterValueGroup: "false, true"
    summary: A boolean indicating whether or not to disable module-scoped SAS keys for authentication.
    description: ''
  - name: --edr --enforce-data-residency
    parameterValueGroup: "false, true"
    summary: Enforce data residency for this IoT Hub by disabling cross-region disaster recovery. This property is immutable once set on the resource. Only available in select regions. Learn more at https://aka.ms/iothubdisabledr.
    description: ''
  - name: --fc --fileupload-storage-container-name
    summary: The name of the root container where you upload files. The container need not exist but should be creatable using the connectionString specified.
    description: ''
  - name: --fcs --fileupload-storage-connectionstring
    summary: The connection string for the Azure Storage account to which files are uploaded.
    description: ''
  - name: --fd --feedback-max-delivery-count
    defaultValue: "10"
    summary: The number of times the IoT hub attempts to deliver a message on the feedback queue, between 1 and 100.
    description: ''
  - name: --feedback-lock-duration --fld
    defaultValue: "5"
    summary: The lock duration for the feedback queue, between 5 and 300 seconds.
    description: ''
  - name: --feedback-ttl --ft
    defaultValue: "1"
    summary: The period of time for which the IoT hub will maintain the feedback for expiration or delivery of cloud-to-device messages, between 1 and 48 hours.
    description: ''
  - name: --fileupload-notification-lock-duration --fnld
    defaultValue: "5"
    summary: The lock duration for the file upload notifications queue, between 5 and 300 seconds.
    description: ''
  - name: --fileupload-notification-max-delivery-count --fnd
    defaultValue: "10"
    summary: The number of times the IoT hub will attempt to deliver a file notification message, between 1 and 100.
    description: ''
  - name: --fileupload-notification-ttl --fnt
    defaultValue: "1"
    summary: The amount of time a file upload notification is available for the service to consume before it is expired by IoT Hub, between 1 and 48 hours.
    description: ''
  - name: --fileupload-notifications --fn
    defaultValue: "False"
    parameterValueGroup: "false, true"
    summary: A boolean indicating whether to log information about uploaded files to the messages/servicebound/filenotifications IoT Hub endpoint.
    description: ''
  - name: --fileupload-sas-ttl --fst
    defaultValue: "1"
    summary: The amount of time a SAS URI generated by IoT Hub is valid before it expires, between 1 and 24 hours.
    description: ''
  - name: --fileupload-storage-auth-type --fsa
    parameterValueGroup: "identityBased, keyBased"
    summary: The authentication type for the Azure Storage account to which files are uploaded.
    description: ''
  - name: --fileupload-storage-identity --fsi
    summary: The managed identity to use for file upload authentication. Use '[system]' to refer to the system-assigned managed identity or a resource ID to refer to a user-assigned managed identity.
    description: ''
  - name: --location -l
    summary: Location of your IoT Hub. Default is the location of target resource group.
    description: ''
  - name: --mi-system-assigned
    parameterValueGroup: "false, true"
    summary: Enable system-assigned managed identity for this hub.
    description: ''
  - name: --mi-user-assigned
    summary: Enable user-assigned managed identities for this hub. Accept space-separated list of identity resource IDs.
    description: ''
  - name: --min-tls-version --mintls
    summary: Specify the minimum TLS version to support for this hub. Can be set to "1.2" to have clients that use a TLS version below 1.2 to be rejected.
    description: ''
  - name: --no-wait
    defaultValue: "False"
    summary: Do not wait for the long-running operation to finish.
    description: ''
  - name: --partition-count
    defaultValue: "4"
    summary: The number of partitions of the backing Event Hub for device-to-cloud messages.
    description: ''
  - name: --rd --retention-day
    defaultValue: "1"
    summary: Specifies how long this IoT hub will maintain device-to-cloud events, between 1 and 7 days.
    description: ''
  - name: --role
    summary: Role to assign to the hub's system-assigned managed identity.
    description: ''
  - name: --scopes
    summary: Space separated list of scopes to assign the role (--role) for the system-assigned managed identity.
    description: ''
  - name: --sku
    defaultValue: "S1"
    parameterValueGroup: "B1, B2, B3, F1, S1, S2, S3"
    summary: Pricing tier for Azure IoT Hub. Note that only one free IoT hub instance (F1) is allowed in each subscription. Exception will be thrown if free instances exceed one.
    description: ''
  - name: --tags
    summary: 'Space-separated tags: key[=value] [key[=value] ...]. Use "" to clear existing tags.'
    description: ''
  - name: --unit
    defaultValue: "1"
    summary: Units in your IoT Hub.
    description: ''
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/iot/_help.py
- uid: az_iot_hub_delete
  name: az iot hub delete
  summary: Delete an IoT hub.
  description: ''
  syntax: >-
    az iot hub delete [--ids]
                      [--name]
                      [--no-wait]
                      [--resource-group]
                      [--subscription]
  examples:
  - summary: Delete an IoT hub. (autogenerated)
    syntax: az iot hub delete --name MyIoTHub --resource-group MyResourceGroup
  optionalParameters:
  - name: --ids
    summary: One or more resource IDs (space-delimited). It should be a complete resource ID containing all information of 'Resource Id' arguments. You should provide either --ids or other 'Resource Id' arguments.
    description: ''
  - name: --name -n
    summary: IoT Hub name.
    description: ''
  - name: --no-wait
    defaultValue: "False"
    summary: Do not wait for the long-running operation to finish.
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --subscription
    summary: Name or ID of subscription. You can configure the default subscription using `az account set -s NAME_OR_ID`.
    description: ''
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/iot/_help.py
- uid: az_iot_hub_generate-sas-token
  name: az iot hub generate-sas-token
  summary: Generate a SAS token for a target IoT Hub, device or module.
  description: For device SAS tokens, the policy parameter is used to access the the device registry only. Therefore the policy should have read access to the registry. For IoT Hub tokens the policy is part of the SAS.
  syntax: >-
    az iot hub generate-sas-token [--auth-type {key, login}]
                                  [--connection-string]
                                  [--device-id]
                                  [--du]
                                  [--hub-name]
                                  [--key-type {primary, secondary}]
                                  [--login]
                                  [--module-id]
                                  [--pn]
                                  [--resource-group]
  examples:
  - summary: Generate an IoT Hub SAS token using the iothubowner policy and primary key.
    syntax: az iot hub generate-sas-token -n {iothub_name}
  - summary: Generate an IoT Hub SAS token using the registryRead policy and secondary key.
    syntax: az iot hub generate-sas-token -n {iothub_name} --policy registryRead --key-type secondary
  - summary: Generate a device SAS token using the iothubowner policy to access the {iothub_name} device registry.
    syntax: az iot hub generate-sas-token -d {device_id} -n {iothub_name}
  - summary: Generate a device SAS token using an IoT Hub connection string (with registry access)
    syntax: az iot hub generate-sas-token -d {device_id} --login 'HostName=myhub.azure-devices.net;SharedAccessKeyName=iothubowner;SharedAccessKey=12345'
  - summary: Generate an Iot Hub SAS token using an IoT Hub connection string
    syntax: az iot hub generate-sas-token --connection-string 'HostName=myhub.azure-devices.net;SharedAccessKeyName=iothubowner;SharedAccessKey=12345'
  - summary: Generate a Device SAS token using a Device connection string
    syntax: az iot hub generate-sas-token --connection-string 'HostName=myhub.azure-devices.net;DeviceId=mydevice;SharedAccessKeyName=iothubowner;SharedAccessKey=12345'
  - summary: Generate a Module SAS token using a Module connection string
    syntax: az iot hub generate-sas-token --connection-string 'HostName=myhub.azure-devices.net;DeviceId=mydevice;ModuleId=mymodule;SharedAccessKeyName=iothubowner;SharedAccessKey=12345'
  optionalParameters:
  - name: --auth-type
    defaultValue: "key"
    parameterValueGroup: "key, login"
    summary: Indicates whether the operation should auto-derive a policy key or use the current Azure AD session. You can configure the default using `az configure --defaults iothub-data-auth-type=<auth-type-value>`.
    description: ''
  - name: --connection-string --cs
    summary: 'Target connection string. This bypasses the IoT Hub registry and generates the SAS token directly from the supplied symmetric key without further validation. All other command parameters aside from duration will be ignored. Supported connection string types: Iot Hub, Device, Module.'
    description: ''
  - name: --device-id -d
    summary: Target Device Id.
    description: ''
  - name: --du --duration
    defaultValue: "3600"
    summary: Valid token duration in seconds.
    description: ''
  - name: --hub-name -n
    summary: IoT Hub name. Required if --login is not provided.
    description: ''
  - name: --key-type --kt
    defaultValue: "primary"
    parameterValueGroup: "primary, secondary"
    summary: Shared access policy key type for authentication.
    description: ''
  - name: --login -l
    summary: This command supports an entity connection string with rights to perform action. Use to avoid session login via "az login". If both an entity connection string and name are provided the connection string takes priority. Required if --hub-name is not provided.
    description: ''
  - name: --module-id -m
    summary: Target Module Id.
    description: ''
  - name: --pn --policy-name
    defaultValue: "iothubowner"
    summary: Shared access policy with operation permissions for target IoT Hub entity.
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
- uid: az_iot_hub_invoke-device-method
  name: az iot hub invoke-device-method
  summary: Invoke a device method.
  description: ''
  syntax: >-
    az iot hub invoke-device-method --device-id
                                    --method-name
                                    [--auth-type {key, login}]
                                    [--hub-name]
                                    [--login]
                                    [--method-payload]
                                    [--resource-group]
                                    [--timeout]
  examples:
  - summary: Invoke a direct method on a device.
    syntax: az iot hub invoke-device-method --hub-name {iothub_name} --device-id {device_id} --method-name Reboot --method-payload '{"version":"1.0"}'
  requiredParameters:
  - isRequired: true
    name: --device-id -d
    summary: Target Device Id.
    description: ''
  - isRequired: true
    name: --method-name --mn
    summary: Target method for invocation.
    description: ''
  optionalParameters:
  - name: --auth-type
    defaultValue: "key"
    parameterValueGroup: "key, login"
    summary: Indicates whether the operation should auto-derive a policy key or use the current Azure AD session. You can configure the default using `az configure --defaults iothub-data-auth-type=<auth-type-value>`.
    description: ''
  - name: --hub-name -n
    summary: IoT Hub name. Required if --login is not provided.
    description: ''
  - name: --login -l
    summary: This command supports an entity connection string with rights to perform action. Use to avoid session login via "az login". If both an entity connection string and name are provided the connection string takes priority. Required if --hub-name is not provided.
    description: ''
  - name: --method-payload --mp
    defaultValue: "{}"
    summary: Json payload to be passed to method. Must be file path or raw json.
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --timeout --to
    defaultValue: "30"
    summary: Maximum number of seconds to wait for the device method result.
    description: ''
- uid: az_iot_hub_invoke-module-method
  name: az iot hub invoke-module-method
  summary: Invoke a module method.
  description: This command supports both edge and non-edge device modules.
  syntax: >-
    az iot hub invoke-module-method --device-id
                                    --method-name
                                    --module-id
                                    [--auth-type {key, login}]
                                    [--hub-name]
                                    [--login]
                                    [--method-payload]
                                    [--resource-group]
                                    [--timeout]
  examples:
  - summary: Invoke a direct method on an edge device module.
    syntax: "az iot hub invoke-module-method -n {iothub_name} -d {device_id} -m '$edgeAgent' --method-name 'RestartModule' --method-payload '{\"schemaVersion\": \"1.0\"}'"
  requiredParameters:
  - isRequired: true
    name: --device-id -d
    summary: Target Device Id.
    description: ''
  - isRequired: true
    name: --method-name --mn
    summary: Target method for invocation.
    description: ''
  - isRequired: true
    name: --module-id -m
    summary: Target Module Id.
    description: ''
  optionalParameters:
  - name: --auth-type
    defaultValue: "key"
    parameterValueGroup: "key, login"
    summary: Indicates whether the operation should auto-derive a policy key or use the current Azure AD session. You can configure the default using `az configure --defaults iothub-data-auth-type=<auth-type-value>`.
    description: ''
  - name: --hub-name -n
    summary: IoT Hub name. Required if --login is not provided.
    description: ''
  - name: --login -l
    summary: This command supports an entity connection string with rights to perform action. Use to avoid session login via "az login". If both an entity connection string and name are provided the connection string takes priority. Required if --hub-name is not provided.
    description: ''
  - name: --method-payload --mp
    defaultValue: "{}"
    summary: Json payload to be passed to method. Must be file path or raw json.
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --timeout --to
    defaultValue: "30"
    summary: Maximum number of seconds to wait for the module method result.
    description: ''
- uid: az_iot_hub_list
  name: az iot hub list
  summary: List IoT hubs.
  description: ''
  syntax: az iot hub list [--resource-group]
  examples:
  - summary: List all IoT hubs in a subscription.
    syntax: az iot hub list
  - summary: List all IoT hubs in the resource group 'MyGroup'
    syntax: az iot hub list --resource-group MyGroup
  optionalParameters:
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/iot/_help.py
- uid: az_iot_hub_list-skus
  name: az iot hub list-skus
  summary: List available pricing tiers.
  description: ''
  syntax: >-
    az iot hub list-skus [--ids]
                         [--name]
                         [--resource-group]
                         [--subscription]
  examples:
  - summary: List available pricing tiers. (autogenerated)
    syntax: az iot hub list-skus --name MyIoTHub
  optionalParameters:
  - name: --ids
    summary: One or more resource IDs (space-delimited). It should be a complete resource ID containing all information of 'Resource Id' arguments. You should provide either --ids or other 'Resource Id' arguments.
    description: ''
  - name: --name -n
    summary: IoT Hub name.
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --subscription
    summary: Name or ID of subscription. You can configure the default subscription using `az account set -s NAME_OR_ID`.
    description: ''
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/iot/_help.py
- uid: az_iot_hub_manual-failover
  name: az iot hub manual-failover
  summary: Initiate a manual failover for the IoT Hub to the geo-paired disaster recovery region.
  description: ''
  syntax: >-
    az iot hub manual-failover [--ids]
                               [--name]
                               [--no-wait]
                               [--resource-group]
                               [--subscription]
  examples:
  - summary: Initiate failover “myhub” from primary to secondary region.
    syntax: az iot hub manual-failover -n myhub
  optionalParameters:
  - name: --ids
    summary: One or more resource IDs (space-delimited). It should be a complete resource ID containing all information of 'Resource Id' arguments. You should provide either --ids or other 'Resource Id' arguments.
    description: ''
  - name: --name -n
    summary: IoT Hub name.
    description: ''
  - name: --no-wait
    defaultValue: "False"
    summary: Do not wait for the long-running operation to finish.
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --subscription
    summary: Name or ID of subscription. You can configure the default subscription using `az account set -s NAME_OR_ID`.
    description: ''
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/iot/_help.py
- uid: az_iot_hub_monitor-events
  name: az iot hub monitor-events
  summary: Monitor device telemetry & messages sent to an IoT Hub.
  description: >-
    This command relies on and may install dependent Cython package (uamqp) upon first execution.

    https://github.com/Azure/azure-uamqp-python.
  syntax: >-
    az iot hub monitor-events [--cg]
                              [--content-type]
                              [--device-id]
                              [--device-query]
                              [--enqueued-time]
                              [--hub-name]
                              [--interface]
                              [--login]
                              [--mc]
                              [--module-id]
                              [--properties {all, anno, app, sys}]
                              [--repair {false, true}]
                              [--resource-group]
                              [--timeout]
                              [--yes {false, true}]
  examples:
  - summary: Basic usage
    syntax: az iot hub monitor-events -n {iothub_name}
  - summary: Basic usage with an IoT Hub connection string
    syntax: az iot hub monitor-events -n {iothub_name} --login 'HostName=myhub.azure-devices.net;SharedAccessKeyName=iothubowner;SharedAccessKey=12345'
  - summary: Basic usage when filtering on target device
    syntax: az iot hub monitor-events -n {iothub_name} -d {device_id}
  - summary: Basic usage when filtering targeted devices with a wildcard in the ID
    syntax: az iot hub monitor-events -n {iothub_name} -d Device*
  - summary: Filter devices using IoT Hub query language
    syntax: az iot hub monitor-events -n {iothub_name} -q "select * from devices where tags.location.region = 'US'"
  - summary: Filter device and specify an Event Hub consumer group to bind to.
    syntax: az iot hub monitor-events -n {iothub_name} -d {device_id} --cg {consumer_group_name}
  - summary: Receive message annotations (message headers)
    syntax: az iot hub monitor-events -n {iothub_name} -d {device_id} --properties anno
  - summary: Receive message annotations + system properties. Never time out.
    syntax: az iot hub monitor-events -n {iothub_name} -d {device_id} --properties anno sys --timeout 0
  - summary: Receive all message attributes from all device messages
    syntax: az iot hub monitor-events -n {iothub_name} --props all
  - summary: Receive all messages and parse message payload as JSON
    syntax: az iot hub monitor-events -n {iothub_name} --content-type application/json
  - summary: Receive the specified number of messages from hub and then shut down.
    syntax: az iot hub monitor-events -n {iothub_name} --message-count {message_count}
  optionalParameters:
  - name: --cg --consumer-group -c
    defaultValue: "$Default"
    summary: Specify the consumer group to use when connecting to event hub endpoint.
    description: ''
  - name: --content-type --ct
    summary: Specify the Content-Type of the message payload to automatically format the output to that type.
    description: ''
  - name: --device-id -d
    summary: Target Device Id.
    description: ''
  - name: --device-query -q
    summary: Specify a custom query to filter devices.
    description: ''
  - name: --enqueued-time --et -e
    summary: Indicates the time that should be used as a starting point to read messages from the partitions. Units are milliseconds since unix epoch. If no time is indicated "now" is used.
    description: ''
  - name: --hub-name -n
    summary: IoT Hub name. Required if --login is not provided.
    description: ''
  - name: --interface -i
    summary: 'Target interface identifier to filter on. For example: dtmi:com:example:TemperatureController;1.'
    description: ''
  - name: --login -l
    summary: This command supports an entity connection string with rights to perform action. Use to avoid session login via "az login". If both an entity connection string and name are provided the connection string takes priority. Required if --hub-name is not provided.
    description: ''
  - name: --mc --message-count
    summary: Number of telemetry messages to capture before the monitor is terminated. If not specified, monitor keeps running until meeting the timeout threshold of not receiving messages from hub.
    description: ''
  - name: --module-id -m
    summary: Target Module Id.
    description: ''
  - name: --properties --props -p
    parameterValueGroup: "all, anno, app, sys"
    summary: Indicate key message properties to output. sys = system properties, app = application properties, anno = annotations.
    description: ''
  - name: --repair -r
    defaultValue: "False"
    parameterValueGroup: "false, true"
    summary: 'Reinstall uamqp dependency compatible with extension version. Default: false.'
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --timeout --to -t
    defaultValue: "300"
    summary: Maximum seconds to maintain connection without receiving message. Use 0 for infinity.
    description: ''
  - name: --yes -y
    defaultValue: "False"
    parameterValueGroup: "false, true"
    summary: 'Skip user prompts. Indicates acceptance of action. Used primarily for automation scenarios. Default: false.'
    description: ''
- uid: az_iot_hub_monitor-feedback
  name: az iot hub monitor-feedback
  summary: Monitor feedback sent by devices to acknowledge cloud-to-device (C2D) messages.
  description: >-
    This command relies on and may install dependent Cython package (uamqp) upon first execution.

    https://github.com/Azure/azure-uamqp-python.
  syntax: >-
    az iot hub monitor-feedback [--auth-type {key, login}]
                                [--device-id]
                                [--hub-name]
                                [--login]
                                [--repair {false, true}]
                                [--resource-group]
                                [--wait-on-msg]
                                [--yes {false, true}]
  examples:
  - summary: Basic usage
    syntax: az iot hub monitor-feedback -n {iothub_name}
  - summary: Basic usage with an IoT Hub connection string
    syntax: az iot hub monitor-feedback -n {iothub_name} --login 'HostName=myhub.azure-devices.net;SharedAccessKeyName=iothubowner;SharedAccessKey=12345'
  - summary: Basic usage when filtering on target device
    syntax: az iot hub monitor-feedback -n {iothub_name} -d {device_id}
  - summary: Exit feedback monitor upon receiving a message with specific id (uuid)
    syntax: az iot hub monitor-feedback -n {iothub_name} -d {device_id} -w {message_id}
  optionalParameters:
  - name: --auth-type
    defaultValue: "key"
    parameterValueGroup: "key, login"
    summary: Indicates whether the operation should auto-derive a policy key or use the current Azure AD session. You can configure the default using `az configure --defaults iothub-data-auth-type=<auth-type-value>`.
    description: ''
  - name: --device-id -d
    summary: Target Device Id.
    description: ''
  - name: --hub-name -n
    summary: IoT Hub name. Required if --login is not provided.
    description: ''
  - name: --login -l
    summary: This command supports an entity connection string with rights to perform action. Use to avoid session login via "az login". If both an entity connection string and name are provided the connection string takes priority. Required if --hub-name is not provided.
    description: ''
  - name: --repair -r
    defaultValue: "False"
    parameterValueGroup: "false, true"
    summary: 'Reinstall uamqp dependency compatible with extension version. Default: false.'
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --wait-on-msg -w
    summary: Feedback monitor will block until a message with specific id (uuid) is received.
    description: ''
  - name: --yes -y
    defaultValue: "False"
    parameterValueGroup: "false, true"
    summary: 'Skip user prompts. Indicates acceptance of action. Used primarily for automation scenarios. Default: false.'
    description: ''
- uid: az_iot_hub_query
  name: az iot hub query
  summary: Query an IoT Hub using a powerful SQL-like language.
  description: Query an IoT Hub using a powerful SQL-like language to retrieve information regarding device and module twins, jobs and message routing. See https://docs.microsoft.com/azure/iot-hub/iot-hub-devguide-query-language for more information.
  syntax: >-
    az iot hub query --query-command
                     [--auth-type {key, login}]
                     [--hub-name]
                     [--login]
                     [--resource-group]
                     [--top]
  examples:
  - summary: Query all device twin data in an Azure IoT Hub.
    syntax: az iot hub query -n {iothub_name} -q "select * from devices"
  - summary: Query all module twin data on target device.
    syntax: az iot hub query -n {iothub_name} -q "select * from devices.modules where devices.deviceId = '{device_id}'"
  requiredParameters:
  - isRequired: true
    name: --query-command -q
    summary: User query to be executed.
    description: ''
  optionalParameters:
  - name: --auth-type
    defaultValue: "key"
    parameterValueGroup: "key, login"
    summary: Indicates whether the operation should auto-derive a policy key or use the current Azure AD session. You can configure the default using `az configure --defaults iothub-data-auth-type=<auth-type-value>`.
    description: ''
  - name: --hub-name -n
    summary: IoT Hub name. Required if --login is not provided.
    description: ''
  - name: --login -l
    summary: This command supports an entity connection string with rights to perform action. Use to avoid session login via "az login". If both an entity connection string and name are provided the connection string takes priority. Required if --hub-name is not provided.
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --top
    summary: Maximum number of elements to return. By default query has no cap.
    description: ''
- uid: az_iot_hub_show
  name: az iot hub show
  summary: Get the details of an IoT hub.
  description: ''
  syntax: >-
    az iot hub show [--ids]
                    [--name]
                    [--resource-group]
                    [--subscription]
  examples:
  - summary: Get the details of an IoT hub. (autogenerated)
    syntax: az iot hub show --name MyIoTHub
  optionalParameters:
  - name: --ids
    summary: One or more resource IDs (space-delimited). It should be a complete resource ID containing all information of 'Resource Id' arguments. You should provide either --ids or other 'Resource Id' arguments.
    description: ''
  - name: --name -n
    summary: IoT Hub name.
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --subscription
    summary: Name or ID of subscription. You can configure the default subscription using `az account set -s NAME_OR_ID`.
    description: ''
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/iot/_help.py
- uid: az_iot_hub_show-connection-string
  name: az iot hub show-connection-string
  summary: Show the connection strings for an IoT hub.
  description: ''
  syntax: >-
    az iot hub show-connection-string [--all]
                                      [--hub-name]
                                      [--ids]
                                      [--key {primary, secondary}]
                                      [--policy-name]
                                      [--resource-group]
                                      [--subscription]
  examples:
  - summary: Show the connection string of an IoT hub using default policy and primary key.
    syntax: az iot hub show-connection-string --name MyIotHub
  - summary: Show the connection string of an IoT Hub using policy 'service' and secondary key.
    syntax: az iot hub show-connection-string --name MyIotHub --policy-name service --key secondary
  - summary: Show the connection strings for all IoT hubs in a resource group.
    syntax: az iot hub show-connection-string --resource-group MyResourceGroup
  - summary: Show the connection strings for all IoT hubs in a subscription.
    syntax: az iot hub show-connection-string
  - summary: Show the connection strings for an IoT hub. (autogenerated)
    syntax: az iot hub show-connection-string --key primary --policy-name MyPolicy
  optionalParameters:
  - name: --all
    defaultValue: "False"
    summary: Allow to show all shared access policies.
    description: ''
  - name: --hub-name --name -n
    summary: IoT Hub name.
    description: ''
  - name: --ids
    summary: One or more resource IDs (space-delimited). It should be a complete resource ID containing all information of 'Resource Id' arguments. You should provide either --ids or other 'Resource Id' arguments.
    description: ''
  - name: --key
    defaultValue: "primary"
    parameterValueGroup: "primary, secondary"
    summary: The key to use.
    description: ''
  - name: --policy-name
    defaultValue: "iothubowner"
    summary: Shared access policy to use.
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --subscription
    summary: Name or ID of subscription. You can configure the default subscription using `az account set -s NAME_OR_ID`.
    description: ''
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/iot/_help.py
- uid: az_iot_hub_show-quota-metrics
  name: az iot hub show-quota-metrics
  summary: Get the quota metrics for an IoT hub.
  description: ''
  syntax: >-
    az iot hub show-quota-metrics [--ids]
                                  [--name]
                                  [--resource-group]
                                  [--subscription]
  examples:
  - summary: Get the quota metrics for an IoT hub. (autogenerated)
    syntax: az iot hub show-quota-metrics --ids {ids}
  - summary: Get the quota metrics for an IoT hub. (autogenerated)
    syntax: az iot hub show-quota-metrics --name MyIoTHub
  optionalParameters:
  - name: --ids
    summary: One or more resource IDs (space-delimited). It should be a complete resource ID containing all information of 'Resource Id' arguments. You should provide either --ids or other 'Resource Id' arguments.
    description: ''
  - name: --name -n
    summary: IoT Hub name.
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --subscription
    summary: Name or ID of subscription. You can configure the default subscription using `az account set -s NAME_OR_ID`.
    description: ''
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/iot/_help.py
- uid: az_iot_hub_show-stats
  name: az iot hub show-stats
  summary: Get the statistics for an IoT hub.
  description: ''
  syntax: >-
    az iot hub show-stats [--ids]
                          [--name]
                          [--resource-group]
                          [--subscription]
  examples:
  - summary: Get the statistics for an IoT hub. (autogenerated)
    syntax: az iot hub show-stats --name MyIoTHub
  optionalParameters:
  - name: --ids
    summary: One or more resource IDs (space-delimited). It should be a complete resource ID containing all information of 'Resource Id' arguments. You should provide either --ids or other 'Resource Id' arguments.
    description: ''
  - name: --name -n
    summary: IoT Hub name.
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --subscription
    summary: Name or ID of subscription. You can configure the default subscription using `az account set -s NAME_OR_ID`.
    description: ''
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/iot/_help.py
- uid: az_iot_hub_update
  name: az iot hub update
  summary: Update metadata for an IoT hub.
  description: ''
  syntax: >-
    az iot hub update [--add]
                      [--c2d-max-delivery-count]
                      [--c2d-ttl]
                      [--dds {false, true}]
                      [--disable-local-auth {false, true}]
                      [--disable-module-sas {false, true}]
                      [--fc]
                      [--fcs]
                      [--fd]
                      [--feedback-lock-duration]
                      [--feedback-ttl]
                      [--fileupload-notification-lock-duration]
                      [--fileupload-notification-max-delivery-count]
                      [--fileupload-notification-ttl]
                      [--fileupload-notifications {false, true}]
                      [--fileupload-sas-ttl]
                      [--fileupload-storage-auth-type {identityBased, keyBased}]
                      [--fileupload-storage-identity]
                      [--force-string]
                      [--ids]
                      [--name]
                      [--rd]
                      [--remove]
                      [--resource-group]
                      [--set]
                      [--sku {B1, B2, B3, F1, S1, S2, S3}]
                      [--subscription]
                      [--tags]
                      [--unit]
  examples:
  - summary: Add storage container settings to file upload
    syntax: az iot hub update --name MyIotHub --fileupload-storage-connectionstring "connection-string" \ --fileupload-storage-container-name "container_name"
  - summary: Add a firewall filter rule to accept traffic from the IP mask 127.0.0.0/31.
    syntax: az iot hub update --name MyIotHub --add properties.ipFilterRules filter_name=test-rule action=Accept ip_mask=127.0.0.0/31
  - summary: Update metadata for an IoT hub. (autogenerated)
    syntax: az iot hub update --name MyIotHub --set properties.allocationPolicy="GeoLatency"
  - summary: Update units of an IoT Hub to 2 and add tags
    syntax: az iot hub update -n MyIotHub --unit 2 --tags a=b c=d
  - summary: Update pricing tier for an IoT Hub as S2
    syntax: az iot hub update -n MyIotHub --sku S2
  - summary: Update the retention days of IoT Hub device-to-cloud events as 3 days
    syntax: az iot hub update -n MyIotHub --retention-day 3
  - summary: Update the IoT Hub cloud-to-device messaging settings
    syntax: az iot hub update --name MyIotHub --c2d-max-delivery-count 30 --c2d-ttl 5
  - summary: Update the IoT Hub feedback queue settings
    syntax: az iot hub update --name MyIoTHub --feedback-max-delivery-count 20 --feedback-lock-duration 100 --feedback-ttl 4
  - summary: Update the IoT Hub file upload settings, and assign a managed identity to user for file upload
    syntax: az iot hub update -n MyIoTHub --fileupload-sas-ttl 5 --fileupload-storage-auth-type identityBased --fileupload-storage-identity [system]
  - summary: Update the IoT Hub file upload notification settings and queue lock duration
    syntax: az iot hub update -n MyIoTHub --fileupload-notification-max-delivery-count 50 --fileupload-notification-ttl 48 --fileupload-notifications --fileupload-notification-lock-duration 10
  - summary: Update the IoT Hub local authentication, device SAS, and module SAS settings
    syntax: az iot hub update -n MyIoTHub --disable-local-auth --disable-device-sas false --disable-module-sas true
  optionalParameters:
  - name: --add
    defaultValue: "[]"
    summary: 'Add an object to a list of objects by specifying a path and key value pairs.  Example: --add property.listProperty <key=value, string or JSON string>.'
    description: ''
  - name: --c2d-max-delivery-count --cdd
    summary: The number of times the IoT hub will attempt to deliver a cloud-to-device message to a device, between 1 and 100.
    description: ''
  - name: --c2d-ttl --ct
    summary: The amount of time a message is available for the device to consume before it is expired by IoT Hub, between 1 and 48 hours.
    description: ''
  - name: --dds --disable-device-sas
    parameterValueGroup: "false, true"
    summary: A boolean indicating whether or not to disable all device (including Edge devices but excluding modules) scoped SAS keys for authentication.
    description: ''
  - name: --disable-local-auth --dla
    parameterValueGroup: "false, true"
    summary: A boolean indicating whether or not to disable IoT hub scoped SAS keys for authentication.
    description: ''
  - name: --disable-module-sas --dms
    parameterValueGroup: "false, true"
    summary: A boolean indicating whether or not to disable module-scoped SAS keys for authentication.
    description: ''
  - name: --fc --fileupload-storage-container-name
    summary: The name of the root container where you upload files. The container need not exist but should be creatable using the connectionString specified.
    description: ''
  - name: --fcs --fileupload-storage-connectionstring
    summary: The connection string for the Azure Storage account to which files are uploaded.
    description: ''
  - name: --fd --feedback-max-delivery-count
    summary: The number of times the IoT hub attempts to deliver a message on the feedback queue, between 1 and 100.
    description: ''
  - name: --feedback-lock-duration --fld
    summary: The lock duration for the feedback queue, between 5 and 300 seconds.
    description: ''
  - name: --feedback-ttl --ft
    summary: The period of time for which the IoT hub will maintain the feedback for expiration or delivery of cloud-to-device messages, between 1 and 48 hours.
    description: ''
  - name: --fileupload-notification-lock-duration --fnld
    summary: The lock duration for the file upload notifications queue, between 5 and 300 seconds.
    description: ''
  - name: --fileupload-notification-max-delivery-count --fnd
    summary: The number of times the IoT hub will attempt to deliver a file notification message, between 1 and 100.
    description: ''
  - name: --fileupload-notification-ttl --fnt
    summary: The amount of time a file upload notification is available for the service to consume before it is expired by IoT Hub, between 1 and 48 hours.
    description: ''
  - name: --fileupload-notifications --fn
    parameterValueGroup: "false, true"
    summary: A boolean indicating whether to log information about uploaded files to the messages/servicebound/filenotifications IoT Hub endpoint.
    description: ''
  - name: --fileupload-sas-ttl --fst
    summary: The amount of time a SAS URI generated by IoT Hub is valid before it expires, between 1 and 24 hours.
    description: ''
  - name: --fileupload-storage-auth-type --fsa
    parameterValueGroup: "identityBased, keyBased"
    summary: The authentication type for the Azure Storage account to which files are uploaded.
    description: ''
  - name: --fileupload-storage-identity --fsi
    summary: The managed identity to use for file upload authentication. Use '[system]' to refer to the system-assigned managed identity or a resource ID to refer to a user-assigned managed identity.
    description: ''
  - name: --force-string
    defaultValue: "False"
    summary: When using 'set' or 'add', preserve string literals instead of attempting to convert to JSON.
    description: ''
  - name: --ids
    summary: One or more resource IDs (space-delimited). It should be a complete resource ID containing all information of 'Resource Id' arguments. You should provide either --ids or other 'Resource Id' arguments.
    description: ''
  - name: --name -n
    summary: IoT Hub name.
    description: ''
  - name: --rd --retention-day
    summary: Specifies how long this IoT hub will maintain device-to-cloud events, between 1 and 7 days.
    description: ''
  - name: --remove
    defaultValue: "[]"
    summary: 'Remove a property or an element from a list.  Example: --remove property.list <indexToRemove> OR --remove propertyToRemove.'
    description: ''
  - name: --resource-group -g
    summary: Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
    description: ''
  - name: --set
    defaultValue: "[]"
    summary: 'Update an object by specifying a property path and value to set.  Example: --set property1.property2=<value>.'
    description: ''
  - name: --sku
    parameterValueGroup: "B1, B2, B3, F1, S1, S2, S3"
    summary: Pricing tier for Azure IoT Hub. Note that only one free IoT hub instance (F1) is allowed in each subscription. Exception will be thrown if free instances exceed one.
    description: ''
  - name: --subscription
    summary: Name or ID of subscription. You can configure the default subscription using `az account set -s NAME_OR_ID`.
    description: ''
  - name: --tags
    summary: 'Space-separated tags: key[=value] [key[=value] ...]. Use "" to clear existing tags.'
    description: ''
  - name: --unit
    summary: Units in your IoT Hub.
    description: ''
  editLink: https://github.com/Azure/azure-cli/blob/dev/src/azure-cli/azure/cli/command_modules/iot/_help.py
commands:
- az_iot_hub_certificate
- az_iot_hub_certificate_create
- az_iot_hub_certificate_delete
- az_iot_hub_certificate_generate-verification-code
- az_iot_hub_certificate_list
- az_iot_hub_certificate_root-authority
- az_iot_hub_certificate_root-authority_set
- az_iot_hub_certificate_root-authority_show
- az_iot_hub_certificate_show
- az_iot_hub_certificate_update
- az_iot_hub_certificate_verify
- az_iot_hub_configuration
- az_iot_hub_configuration_create
- az_iot_hub_configuration_delete
- az_iot_hub_configuration_list
- az_iot_hub_configuration_show
- az_iot_hub_configuration_show-metric
- az_iot_hub_configuration_update
- az_iot_hub_connection-string
- az_iot_hub_connection-string_show
- az_iot_hub_consumer-group
- az_iot_hub_consumer-group_create
- az_iot_hub_consumer-group_delete
- az_iot_hub_consumer-group_list
- az_iot_hub_consumer-group_show
- az_iot_hub_create
- az_iot_hub_delete
- az_iot_hub_device-identity
- az_iot_hub_device-identity_children
- az_iot_hub_device-identity_children_add
- az_iot_hub_device-identity_children_list
- az_iot_hub_device-identity_children_remove
- az_iot_hub_device-identity_connection-string
- az_iot_hub_device-identity_connection-string_show
- az_iot_hub_device-identity_create
- az_iot_hub_device-identity_delete
- az_iot_hub_device-identity_export
- az_iot_hub_device-identity_import
- az_iot_hub_device-identity_list
- az_iot_hub_device-identity_parent
- az_iot_hub_device-identity_parent_set
- az_iot_hub_device-identity_parent_show
- az_iot_hub_device-identity_renew-key
- az_iot_hub_device-identity_show
- az_iot_hub_device-identity_update
- az_iot_hub_device-twin
- az_iot_hub_device-twin_list
- az_iot_hub_device-twin_replace
- az_iot_hub_device-twin_show
- az_iot_hub_device-twin_update
- az_iot_hub_devicestream
- az_iot_hub_devicestream_show
- az_iot_hub_digital-twin
- az_iot_hub_digital-twin_invoke-command
- az_iot_hub_digital-twin_show
- az_iot_hub_digital-twin_update
- az_iot_hub_distributed-tracing
- az_iot_hub_distributed-tracing_show
- az_iot_hub_distributed-tracing_update
- az_iot_hub_generate-sas-token
- az_iot_hub_identity
- az_iot_hub_identity_assign
- az_iot_hub_identity_remove
- az_iot_hub_identity_show
- az_iot_hub_invoke-device-method
- az_iot_hub_invoke-module-method
- az_iot_hub_job
- az_iot_hub_job_cancel
- az_iot_hub_job_create
- az_iot_hub_job_list
- az_iot_hub_job_show
- az_iot_hub_list
- az_iot_hub_list-skus
- az_iot_hub_manual-failover
- az_iot_hub_message-endpoint
- az_iot_hub_message-endpoint_create
- az_iot_hub_message-endpoint_create_cosmosdb-container
- az_iot_hub_message-endpoint_create_eventhub
- az_iot_hub_message-endpoint_create_servicebus-queue
- az_iot_hub_message-endpoint_create_servicebus-topic
- az_iot_hub_message-endpoint_create_storage-container
- az_iot_hub_message-endpoint_delete
- az_iot_hub_message-endpoint_list
- az_iot_hub_message-endpoint_show
- az_iot_hub_message-enrichment
- az_iot_hub_message-enrichment_create
- az_iot_hub_message-enrichment_delete
- az_iot_hub_message-enrichment_list
- az_iot_hub_message-enrichment_update
- az_iot_hub_message-route
- az_iot_hub_message-route_create
- az_iot_hub_message-route_delete
- az_iot_hub_message-route_fallback
- az_iot_hub_message-route_fallback_set
- az_iot_hub_message-route_fallback_show
- az_iot_hub_message-route_list
- az_iot_hub_message-route_show
- az_iot_hub_message-route_test
- az_iot_hub_message-route_update
- az_iot_hub_module-identity
- az_iot_hub_module-identity_connection-string
- az_iot_hub_module-identity_connection-string_show
- az_iot_hub_module-identity_create
- az_iot_hub_module-identity_delete
- az_iot_hub_module-identity_list
- az_iot_hub_module-identity_renew-key
- az_iot_hub_module-identity_show
- az_iot_hub_module-identity_update
- az_iot_hub_module-twin
- az_iot_hub_module-twin_replace
- az_iot_hub_module-twin_show
- az_iot_hub_module-twin_update
- az_iot_hub_monitor-events
- az_iot_hub_monitor-feedback
- az_iot_hub_policy
- az_iot_hub_policy_create
- az_iot_hub_policy_delete
- az_iot_hub_policy_list
- az_iot_hub_policy_renew-key
- az_iot_hub_policy_show
- az_iot_hub_query
- az_iot_hub_route
- az_iot_hub_route_create
- az_iot_hub_route_delete
- az_iot_hub_route_list
- az_iot_hub_route_show
- az_iot_hub_route_test
- az_iot_hub_route_update
- az_iot_hub_routing-endpoint
- az_iot_hub_routing-endpoint_create
- az_iot_hub_routing-endpoint_delete
- az_iot_hub_routing-endpoint_list
- az_iot_hub_routing-endpoint_show
- az_iot_hub_show
- az_iot_hub_show-connection-string
- az_iot_hub_show-quota-metrics
- az_iot_hub_show-stats
- az_iot_hub_update
globalParameters:
- name: --debug
  summary: Increase logging verbosity to show all debug logs.
- name: --help -h
  summary: Show this help message and exit.
- name: --only-show-errors
  summary: Only show errors, suppressing warnings.
- name: --output -o
  defaultValue: "json"
  parameterValueGroup: "json, jsonc, table, tsv"
  summary: Output format.
- name: --query
  summary: JMESPath query string. See <a href="http://jmespath.org/">http://jmespath.org/</a> for more information and examples.
- name: --subscription
  summary: Name or ID of subscription. You can configure the default subscription using `az account set -s NAME_OR_ID`.
- name: --verbose
  summary: Increase logging verbosity. Use --debug for full debug logs.
metadata:
  description: Manage Azure IoT hubs.
